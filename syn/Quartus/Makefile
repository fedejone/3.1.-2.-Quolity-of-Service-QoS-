########################################
#  This file was generated by hdlmake  #
#  http://ohwr.org/projects/hdl-make/  #
#  v         #
########################################

TOP_MODULE := stream_arbiter_top
PROJECT := stream_arbiter_top
PROJECT_FILE := $(PROJECT).qpf
TOOL_PATH := 
TCL_INTERPRETER := quartus_sh.exe -t
ifneq ($(strip $(TOOL_PATH)),)
TCL_INTERPRETER := $(TOOL_PATH)/$(TCL_INTERPRETER)
endif

SYN_FAMILY := Cyclone IV E
SYN_DEVICE := EP4CE115F29C7
SYN_PACKAGE := F29
SYN_GRADE := C7

TCL_CREATE := project_new $(PROJECT)
TCL_OPEN := project_open $(PROJECT)
ifneq ($(wildcard $(PROJECT_FILE)),)
TCL_CREATE := $(TCL_OPEN)
endif

#target for performing local synthesis
all: bitstream

analysis_and_elaboration: analyze_elaborate

postmodule:
		$(TCL_INTERPRETER) module.tcl

SOURCES_SVFile := \
../../rtl/stream_arbiter_latency_0.sv \
../../rtl/stream_arbiter_latency_1.sv \
../../rtl/stream_arbiter_top.sv

files.tcl:
		@echo set_global_assignment -name POST_MODULE_SCRIPT_FILE "quartus_sh:module.tcl" >> $@
		@$(foreach sourcefile, $(SOURCES_SVFile), echo set_global_assignment -name SYSTEMVERILOG_FILE $(sourcefile) -library work >> $@ &)

SYN_PRE_PROJECT_CMD := 
SYN_POST_PROJECT_CMD := 

SYN_PRE_BITSTREAM_CMD := 
SYN_POST_BITSTREAM_CMD := 

analyze_elaborate.tcl:
		echo load_package flow >> $@
		echo $(TCL_OPEN) >> $@
		echo execute_flow -analysis_and_elaboration >> $@

analyze_elaborate: project analyze_elaborate.tcl
		$(TCL_INTERPRETER) $@.tcl
		type nul >> $@

project.tcl:
		echo load_package flow >> $@
		echo $(TCL_CREATE) >> $@
		echo remove_all_global_assignments -name *_FILE >> $@
		echo source files.tcl >> $@
		echo set_global_assignment -name FAMILY "$(SYN_FAMILY)" >> $@
		echo set_global_assignment -name DEVICE "$(SYN_DEVICE)" >> $@
		echo set_global_assignment -name TOP_LEVEL_ENTITY "$(TOP_MODULE)" >> $@
		echo set_global_assignment -name NUM_PARALLEL_PROCESSORS "ALL" >> $@
		echo set_global_assignment -name VHDL_INPUT_VERSION "VHDL_2008" >> $@
		echo set_global_assignment -name VERILOG_INPUT_VERSION "SYSTEMVERILOG_2005" >> $@
		echo set_global_assignment -name optimization_technique "BALANCED" >> $@

project: files.tcl project.tcl
		$(SYN_PRE_PROJECT_CMD)
		$(TCL_INTERPRETER) $@.tcl
		$(SYN_POST_PROJECT_CMD)
		type nul >> $@

bitstream.tcl:
		echo load_package flow >> $@
		echo $(TCL_OPEN) >> $@
		echo execute_flow -compile >> $@

bitstream: project bitstream.tcl
		$(SYN_PRE_BITSTREAM_CMD)
		$(TCL_INTERPRETER) $@.tcl
		$(SYN_POST_BITSTREAM_CMD)
		type nul >> $@

CLEAN_TARGETS := $(LIBS) *.rpt *.smsg *.summary *.done *.jdi *.pin *.qws db incremental_db $(PROJECT).qsf *.qpf

clean:
		del /s /q /f $(CLEAN_TARGETS)
		@-rmdir /s /q $(CLEAN_TARGETS) >nul 2>&1
		del /s /q /f project synthesize translate map par bitstream analyze_elaborate
		del /s /q /f project.tcl synthesize.tcl translate.tcl map.tcl par.tcl bitstream.tcl files.tcl analyze_elaborate.tcl

mrproper: clean
		del /s /q /f *.sof *.pof *.jam *.jbc *.ekp *.jic *.sopcinfo

.PHONY: mrproper clean all
